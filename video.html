<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>下载抖音、快手无水印视频 - KingPunch Studio</title>
    <meta content="width=device-width,minimum-scale=1.0" name="viewport">
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Roboto, Helvetica Neue, Arial, sans-serif;
            font-size: 10pt;
        }

        header {
            display: flex;
            height: 48px;
            width: 100%;
        }

        .outer {
            flex: 1;
            padding-top: 20px;
        }

        .image-wrapper {
            text-align: center;
            margin: 0 10px;
            position: relative;
        }

        .image {
            border: none;
            max-width: 100%;
            margin: 8px 0;
            min-height: 136px;
        }

        .input-wrapper {
            margin: 8px;
        }
    </style>

</head>
<body>
<header></header>
<custom-toast id="toast"></custom-toast>
<div class="outer">
    <div class="image-wrapper">
        <a>
            <div class="image">
                <h1>下载抖音、快手无水印视频</h1>
            </div>
        </a>
    </div>

    <div class="input-wrapper">
        <div style="background: none;border-radius: 20px;">
            <div style="display: flex;z-index: 3;border-radius: 20px;background: #fff;border: 1px solid #dadce0;">
                <button style="display: flex;border-radius: 0 20px 20px 0;padding: 0 8px;background: transparent;border: none;margin-right: -1px;padding-right: 0;flex: 0 0 auto;">
                    <div style="background: none;color: #9aa0a6;height: 24px;width: 24px;margin: auto;">
                    <span style="color: #9aa0a6;display: inline-block;fill: currentColor;height: 24px;line-height: 24px;position: relative;width: 24px;">
                  <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path
                          d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
                    </span>
                    </div>
                </button>
                <div style="flex: 1;display: flex;padding: 7px 0 6px;">
                    <div style="display: flex;flex: 1;">

                        <input style="line-height: 25px;background-color: transparent;border: none;margin: 0;padding: 0 0 0 19px;font-size: 18px;font-family: Roboto,Helvetica Neue,Arial,sans-serif;color: #202124;word-wrap: break-word;outline: none;display: flex;flex: 1;-webkit-tap-highlight-color: transparent;width: 100%;"
                               maxlength=" 2048" name="q" type="text" aria-autocomplete="both" aria-haspopup="false"
                               autocapitalize="off"
                               autocomplete="off" autocorrect="off" role="combobox" spellcheck="false" tabindex="0"
                               title=""
                               value="" aria-label="搜索">

                    </div>
                </div>

            </div>

        </div>
        <div ></div>
    </div>

</div>
<script>
    class CustomToast extends HTMLElement {
        static get observedAttributes() {
            return ['message'];
        }

        // Fires when an instance of the element is created or updated
        constructor() {
            super();
            this.root = this.attachShadow({
                mode: 'open'
            });
            const style = document.createElement('style');
            style.textContent = CustomToast.getStyle();
            this.root.appendChild(style);
            const c3Toast = document.createElement('DIV');
            c3Toast.setAttribute('class', 'c3-toast');

            const notificationActionRenderer = document.createElement('DIV');
            notificationActionRenderer.setAttribute('class', 'notification-action-renderer');
            const notificationActionResponseText = document.createElement('DIV');
            notificationActionResponseText.setAttribute('class', 'notification-action-response-text');
            notificationActionRenderer.appendChild(notificationActionResponseText);
            c3Toast.appendChild(notificationActionRenderer);
            this.root.appendChild(c3Toast);

            this.c3Toast = c3Toast;
            this.notificationActionResponseText = notificationActionResponseText;
            this.messages = [];
            this.timer = 0;
        }

        // Fires when an instance was inserted into the document
        connectedCallback() {
        }

        // Fires when an instance was removed from the document
        disconnectedCallback() {
        }

        showMessage() {
            if (this.messages.length && !this.showing) {
                const message = this.messages.shift();
                this.notificationActionResponseText.textContent = message;
                this.c3Toast.setAttribute('dir', 'in');
                this.showing = true;
                if (this.timer) {
                    clearTimeout(this.timer);
                }
                this.timer = setTimeout(() => {
                    this.c3Toast.setAttribute('dir', 'out');
                    setTimeout(() => {
                        this.showing = false;
                        this.showMessage();
                    }, 195);
                }, 3000);
            }
        }

        // Fires when an attribute was added, removed, or updated
        attributeChangedCallback(attrName, oldVal, newVal) {
            if (attrName === 'message') {
                this.messages.push(newVal);
                this.showMessage();
            }
        }

        // Fires when an element is moved to a new document
        adoptedCallback() {
        }

        static getTemplate(value) {
            return `
        ${CustomToast.getStyle()}
        <div>
            ${value}
        </div>
        `;
        }

        static getStyle() {
            return `
        .c3-toast[dir="in"] {
            transition: margin 225ms cubic-bezier(0.0, 0.0, 0.2, 1);
            margin-bottom: 0;
        }

        .c3-toast[dir="out"] {
            transition: margin 195ms cubic-bezier(0.4, 0.0, 1, 1);
        }

        .c3-toast {
            display: block;
            position: fixed;
            z-index: 4;
            left: 0;
            right: 0;
            bottom: 0;
            box-sizing: border-box;
            padding: 14px 24px;
            font-size: 1.4rem;
            color: #ffffff;
            background: hsl(0, 0%, 20%);
            will-change: transform;
            margin-bottom: -100%;
        }

        .notification-action-renderer {
            display: flex;
            align-items: center;
        }

        .notification-action-response-text {
            flex-grow: 1;
            padding-right: 1rem;
            font-size:14px;
        }

        `;
        }
    }

    customElements.define('custom-toast', CustomToast);
    // <custom-toast id="toast"></custom-toast>
    // <script src="./components/toast.js"></script>
</script>
<script>
    function writeText(message) {
        const textarea = document.createElement("textarea");
        textarea.style.position = 'fixed';
        textarea.style.right = '100%';
        document.body.appendChild(textarea);
        textarea.value = message;
        textarea.select();
        document.execCommand('copy');
        textarea.remove();
    }

    const input = document.querySelector('input');
    input.focus();

    document.querySelector('button').addEventListener('click', async ev => {

        let q = input.value;
        let match = /https:\/\/v.douyin.com\/[\w]+/.exec(q);
        if (match) {
            q = match[0];
        } else {
            match = /https:\/\/v.kuaishouapp.com\/s\/[\w]+/.exec(q);
            if (match) {
                q = match[0];
            } else {
                q = '';
            }
        }
        if (q) {
            const res = await fetch(`https://1784551678897626.cn-hangzhou.fc.aliyuncs.com/2016-08-15/proxy/try.LATEST/func-90e728i3/?v=${q}`)
            const src = await res.text();
            writeText(src);
            document.getElementById('toast').setAttribute('message', '视频已复制，请用浏览器下载');
        }

    })
    input.addEventListener('keydown', async ev => {
        if (ev.keyCode === 13) {
            ev.preventDefault();
            let q = ev.target.value;
            let match = /https:\/\/v.douyin.com\/[\w]+/.exec(q);
            if (match) {
                q = match[0];
            } else {
                match = /https:\/\/v.kuaishouapp.com\/s\/[\w]+/.exec(q);
                if (match) {
                    q = match[0];
                } else {
                    q = '';
                }
            }
            if (q) {
                const res = await fetch(`https://1784551678897626.cn-hangzhou.fc.aliyuncs.com/2016-08-15/proxy/try.LATEST/func-90e728i3/?v=${q}`)
                const src = await res.text();
                writeText(src);
                document.getElementById('toast').setAttribute('message', '视频已复制，请用浏览器下载');
            }

        }
    })
</script>
</body>
</html>